<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#020202">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Saf. GPT Supreme Zenith v4.0 | ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä ŸÑŸÑŸÖŸÜÿ∑ŸÇ</title>
    
    <!-- ===================== ŸÖÿ™ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿ™ÿµŸÖŸäŸÖ ===================== -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            important: true,
            theme: {
                extend: {
                    colors: {
                        'obsidian': '#020202',
                        'deep-space': '#010101',
                        'cyber-blue': '#0066ff',
                        'quantum-indigo': '#8a2be2',
                        'zenith-violet': '#9400d3',
                        'divine-gold': '#ffd700',
                        'matrix-green': '#00ff00',
                        'neon-pink': '#ff00ff',
                        'hologram-cyan': '#00ffff',
                        'plasma-purple': '#9d00ff',
                        'singularity-white': '#f0f0f0',
                    },
                    fontFamily: {
                        'cairo': ['Cairo', 'system-ui'],
                        'arabic': ['"Noto Sans Arabic"', 'Cairo', 'sans-serif'],
                        'code': ['"Fira Code"', 'monospace'],
                    },
                    animation: {
                        'zenith-float': 'zenithFloat 45s infinite alternate ease-in-out',
                        'quantum-pulse': 'quantumPulse 3s infinite',
                        'hologram-scan': 'hologramScan 10s linear infinite',
                        'data-stream': 'dataStream 20s linear infinite',
                        'neon-flicker': 'neonFlicker 0.1s infinite',
                        'cyber-rain': 'cyberRain 30s linear infinite',
                        'matrix-fall': 'matrixFall 50s linear infinite',
                        'singularity-spin': 'singularitySpin 60s linear infinite',
                        'zenith-glow': 'zenithGlow 2s ease-in-out infinite',
                        'quantum-entangle': 'quantumEntangle 5s linear infinite',
                        'hologram-grid': 'hologramGrid 15s linear infinite',
                        'data-matrix': 'dataMatrix 25s linear infinite',
                        'cyber-wave': 'cyberWave 35s linear infinite',
                        'zenith-breathe': 'zenithBreathe 8s ease-in-out infinite',
                        'quantum-flux': 'quantumFlux 12s linear infinite',
                        'hologram-shift': 'hologramShift 18s linear infinite',
                        'data-flow': 'dataFlow 22s linear infinite',
                        'cyber-orbit': 'cyberOrbit 28s linear infinite',
                        'zenith-pulse': 'zenithPulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'quantum-vibration': 'quantumVibration 0.3s infinite',
                        'hologram-distortion': 'hologramDistortion 7s linear infinite',
                        'data-ripple': 'dataRipple 9s linear infinite',
                        'cyber-spark': 'cyberSpark 0.5s infinite',
                        'zenith-shimmer': 'zenithShimmer 6s linear infinite',
                        'quantum-field': 'quantumField 40s linear infinite',
                        'hologram-construct': 'hologramConstruct 55s linear infinite',
                        'data-transmission': 'dataTransmission 65s linear infinite',
                        'cyber-core': 'cyberCore 75s linear infinite',
                        'zenith-nova': 'zenithNova 85s linear infinite',
                        'quantum-collapse': 'quantumCollapse 95s linear infinite',
                        'hologram-reality': 'hologramReality 105s linear infinite',
                        'data-consciousness': 'dataConsciousness 115s linear infinite',
                        'cyber-awakening': 'cyberAwakening 125s linear infinite',
                        'zenith-ascension': 'zenithAscension 135s linear infinite',
                        'quantum-transcendence': 'quantumTranscendence 145s linear infinite',
                        'hologram-enlightenment': 'hologramEnlightenment 155s linear infinite',
                        'data-omniscience': 'dataOmniscience 165s linear infinite',
                        'cyber-divinity': 'cyberDivinity 175s linear infinite',
                        'zenith-infinity': 'zenithInfinity 185s linear infinite',
                    },
                    backdropBlur: {
                        'zenith': '25px',
                        'quantum': '40px',
                        'hologram': '60px',
                        'divine': '80px',
                        'infinity': '100px',
                    },
                    backgroundImage: {
                        'zenith-gradient': 'linear-gradient(135deg, #0066ff 0%, #8a2be2 25%, #9400d3 50%, #9d00ff 75%, #0066ff 100%)',
                        'quantum-gradient': 'linear-gradient(45deg, #00ff00 0%, #00ffff 25%, #0066ff 50%, #8a2be2 75%, #ff00ff 100%)',
                        'hologram-gradient': 'linear-gradient(90deg, rgba(0,255,0,0.1) 0%, rgba(0,255,255,0.2) 25%, rgba(0,102,255,0.3) 50%, rgba(138,43,226,0.4) 75%, rgba(255,0,255,0.5) 100%)',
                        'divine-gradient': 'radial-gradient(circle at 50% 50%, rgba(255,215,0,0.3) 0%, transparent 70%)',
                        'infinity-gradient': 'conic-gradient(from 0deg, #0066ff, #8a2be2, #9400d3, #9d00ff, #0066ff)',
                    },
                    boxShadow: {
                        'zenith': '0 0 100px rgba(0, 102, 255, 0.5)',
                        'quantum': '0 0 150px rgba(0, 255, 0, 0.4)',
                        'hologram': '0 0 200px rgba(0, 255, 255, 0.3)',
                        'divine': '0 0 250px rgba(255, 215, 0, 0.2)',
                        'infinity': '0 0 300px rgba(255, 0, 255, 0.1)',
                    },
                    spacing: {
                        'safe-top': 'env(safe-area-inset-top)',
                        'safe-bottom': 'env(safe-area-inset-bottom)',
                        'safe-left': 'env(safe-area-inset-left)',
                        'safe-right': 'env(safe-area-inset-right)',
                    },
                    height: {
                        'dvh': '100dvh',
                        'dvh-90': '90dvh',
                        'dvh-80': '80dvh',
                        'dvh-70': '70dvh',
                    },
                    minHeight: {
                        'dvh': '100dvh',
                        'dvh-90': '90dvh',
                        'dvh-80': '80dvh',
                    }
                }
            }
        }
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-php.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        html {
            font-size: 16px;
            scroll-behavior: smooth;
            overscroll-behavior: none;
        }
        
        body {
            font-family: 'Cairo', 'Noto Sans Arabic', system-ui;
            background-color: #020202;
            color: #f0f0f0;
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100dvh;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }
        
        #zenith-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -9999;
            overflow: hidden;
            pointer-events: none;
        }
        
        .radial-glow {
            position: absolute;
            width: 1000px;
            height: 1000px;
            border-radius: 50%;
            filter: blur(150px);
            opacity: 0.3;
            transition: all 0.3s ease;
            will-change: transform, opacity;
        }
        
        .glow-1 {
            background: radial-gradient(circle, #0066ff 0%, transparent 70%);
            animation: zenithGlow 8s ease-in-out infinite alternate;
        }
        
        .glow-2 {
            background: radial-gradient(circle, #8a2be2 0%, transparent 70%);
            animation: zenithGlow 10s ease-in-out infinite alternate-reverse;
        }
        
        .glow-3 {
            background: radial-gradient(circle, #9400d3 0%, transparent 70%);
            animation: zenithGlow 12s ease-in-out infinite alternate;
        }
        
        .hologram-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background-image: 
                linear-gradient(rgba(0, 102, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 102, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: hologramGrid 20s linear infinite;
            transform-origin: center;
        }
        
        .data-stream {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(0deg, 
                transparent 0%, 
                rgba(0, 255, 0, 0.05) 10%,
                transparent 20%,
                rgba(0, 255, 255, 0.05) 30%,
                transparent 40%,
                rgba(0, 102, 255, 0.05) 50%,
                transparent 60%,
                rgba(138, 43, 226, 0.05) 70%,
                transparent 80%,
                rgba(255, 0, 255, 0.05) 90%,
                transparent 100%
            );
            animation: dataStream 30s linear infinite;
        }
        
        .cyber-rain {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg,
                transparent 0%,
                rgba(0, 255, 0, 0.02) 2%,
                transparent 4%,
                rgba(0, 255, 0, 0.02) 6%,
                transparent 8%,
                rgba(0, 255, 0, 0.02) 10%,
                transparent 12%
            );
            animation: cyberRain 40s linear infinite;
        }
        
        .saf-glass {
            background: rgba(2, 2, 2, 0.7);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border: 0.5px solid rgba(255, 255, 255, 0.05);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.36),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .zenith-glass {
            background: rgba(2, 2, 2, 0.85);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border: 0.5px solid rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }
        
        .quantum-glass {
            background: rgba(2, 2, 2, 0.9);
            backdrop-filter: blur(60px) saturate(220%);
            -webkit-backdrop-filter: blur(60px) saturate(220%);
            border: 0.5px solid rgba(0, 102, 255, 0.2);
            box-shadow: 
                0 30px 80px rgba(0, 102, 255, 0.2),
                inset 0 1px 0 rgba(0, 102, 255, 0.3);
        }
        
        .hologram-glass {
            background: rgba(2, 2, 2, 0.75);
            backdrop-filter: blur(80px) saturate(240%);
            -webkit-backdrop-filter: blur(80px) saturate(240%);
            border: 0.5px solid rgba(0, 255, 255, 0.15);
            box-shadow: 
                0 40px 100px rgba(0, 255, 255, 0.15),
                inset 0 1px 0 rgba(0, 255, 255, 0.25);
        }
        
        .diamond-cut {
            border: 0.5px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            position: relative;
        }
        
        .diamond-cut::before {
            content: '';
            position: absolute;
            top: -0.5px;
            left: -0.5px;
            right: -0.5px;
            bottom: -0.5px;
            border-radius: 13px;
            background: linear-gradient(45deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent 100%);
            z-index: -1;
        }
        
        .narcissist-glow {
            text-shadow: 
                0 0 10px rgba(0, 102, 255, 0.5),
                0 0 20px rgba(0, 102, 255, 0.3),
                0 0 30px rgba(0, 102, 255, 0.2);
        }
        
        .zenith-glow {
            text-shadow: 
                0 0 20px rgba(0, 102, 255, 0.7),
                0 0 40px rgba(0, 102, 255, 0.5),
                0 0 60px rgba(0, 102, 255, 0.3);
        }
        
        .quantum-glow {
            text-shadow: 
                0 0 15px rgba(0, 255, 0, 0.7),
                0 0 30px rgba(0, 255, 0, 0.5),
                0 0 45px rgba(0, 255, 0, 0.3);
        }
        
        .hologram-glow {
            text-shadow: 
                0 0 15px rgba(0, 255, 255, 0.7),
                0 0 30px rgba(0, 255, 255, 0.5),
                0 0 45px rgba(0, 255, 255, 0.3);
        }
        
        .input-sanctuary {
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .input-sanctuary:focus-within {
            border-color: rgba(0, 102, 255, 0.4);
            box-shadow: 
                0 0 0 1px rgba(0, 102, 255, 0.2),
                0 0 40px rgba(0, 102, 255, 0.15),
                inset 0 0 20px rgba(0, 102, 255, 0.1);
        }
        
        .input-sanctuary::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 102, 255, 0.05), 
                transparent);
            transform: translateX(-100%);
            animation: zenithShimmer 3s infinite;
        }
        
        .send-btn {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .send-btn.active {
            background: linear-gradient(135deg, #0066ff, #8a2be2);
            color: white;
            box-shadow: 
                0 0 20px rgba(0, 102, 255, 0.4),
                0 0 40px rgba(0, 102, 255, 0.2);
        }
        
        .send-btn.ignite {
            animation: zenithPulse 1s infinite;
        }
        
        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background-color: #0066ff;
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: middle;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .typewriter {
            overflow: hidden;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        @supports (height: 100dvh) {
            .mobile-optimized {
                height: 100dvh;
                max-height: -webkit-fill-available;
            }
        }
        
        .keyboard-adjust {
            transition: all 0.3s ease;
        }
        
        .floating-input {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        
        .floating-input.keyboard-up {
            transform: translateY(-50%);
        }
        
        .touch-gesture {
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }
        
        .long-press {
            transition: background-color 0.3s ease;
        }
        
        .long-press:active {
            background-color: rgba(0, 102, 255, 0.2);
        }
        
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }
        
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .safe-area-left {
            padding-left: env(safe-area-inset-left);
        }
        
        .safe-area-right {
            padding-right: env(safe-area-inset-right);
        }
        
        .settings-panel {
            transform: translateX(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .settings-panel.open {
            transform: translateX(0);
        }
        
        .message-matrix {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .message-matrix:hover .action-toolbar {
            opacity: 1;
            transform: translateY(0);
        }
        
        .action-toolbar {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .message-matrix:hover .action-toolbar {
            pointer-events: all;
        }
        
        .code-hologram {
            background: rgba(0, 10, 20, 0.9);
            border: 1px solid rgba(0, 102, 255, 0.3);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .code-hologram::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent 0%, 
                rgba(0, 102, 255, 0.1) 50%, 
                transparent 100%);
            animation: hologramShift 10s linear infinite;
        }
        
        .status-indicator {
            position: relative;
            overflow: hidden;
        }
        
        .status-indicator::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 102, 255, 0.2), 
                transparent);
            animation: statusFlow 2s infinite;
        }
        
        .searching-galaxy {
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 102, 255, 0.1), 
                transparent);
            background-size: 200% 100%;
            animation: searching 3s infinite;
        }
        
        .no-connection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            background: radial-gradient(circle at center, 
                rgba(2, 2, 2, 0.95) 0%,
                rgba(0, 0, 0, 0.98) 100%);
            display: none;
        }
        
        .no-connection.active {
            display: flex;
        }
        
        .lab-failure {
            position: relative;
            overflow: hidden;
        }
        
        .lab-failure::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent 0%, 
                rgba(255, 0, 0, 0.1) 25%, 
                transparent 50%, 
                rgba(255, 0, 0, 0.1) 75%, 
                transparent 100%);
            animation: failureScan 2s linear infinite;
        }
        
        .scroll-bottom-btn {
            position: fixed;
            bottom: 100px;
            left: 20px;
            z-index: 100;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .scroll-bottom-btn.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        
        ::selection {
            background-color: rgba(0, 102, 255, 0.5);
            color: white;
        }
        
        ::-moz-selection {
            background-color: rgba(0, 102, 255, 0.5);
            color: white;
        }
        
        .gpu-accelerated {
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        @keyframes zenithFloat {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(10%, 5%) scale(1.1); }
            50% { transform: translate(5%, 10%) scale(0.9); }
            75% { transform: translate(-5%, 5%) scale(1.05); }
        }
        
        @keyframes quantumPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        
        @keyframes hologramScan {
            0% { transform: translateY(-100%) rotate(0deg); }
            100% { transform: translateY(100%) rotate(0deg); }
        }
        
        @keyframes dataStream {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        
        @keyframes neonFlicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% { opacity: 1; }
            20%, 24%, 55% { opacity: 0.5; }
        }
        
        @keyframes cyberRain {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }
        
        @keyframes matrixFall {
            0% { 
                transform: translateY(-100%) translateX(0);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(1000%) translateX(100px);
                opacity: 0;
            }
        }
        
        @keyframes singularitySpin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.5); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        @keyframes zenithGlow {
            0%, 100% { opacity: 0.3; filter: blur(150px); }
            50% { opacity: 0.5; filter: blur(120px); }
        }
        
        @keyframes quantumEntangle {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(100px, 50px) rotate(90deg); }
            50% { transform: translate(50px, 100px) rotate(180deg); }
            75% { transform: translate(-50px, 50px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }
        
        @keyframes hologramGrid {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        @keyframes dataMatrix {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }
        
        @keyframes cyberWave {
            0%, 100% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(50px) translateY(-20px); }
            50% { transform: translateX(100px) translateY(0); }
            75% { transform: translateX(50px) translateY(20px); }
        }
        
        @keyframes zenithBreathe {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }
        
        @keyframes quantumFlux {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        @keyframes hologramShift {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }
        
        @keyframes dataFlow {
            0% { transform: scaleX(0); opacity: 0; }
            50% { transform: scaleX(1); opacity: 1; }
            100% { transform: scaleX(0); opacity: 0; }
        }
        
        @keyframes cyberOrbit {
            0% { transform: rotate(0deg) translateX(100px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(100px) rotate(-360deg); }
        }
        
        @keyframes zenithPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 102, 255, 0.4); }
            50% { box-shadow: 0 0 40px rgba(0, 102, 255, 0.8); }
        }
        
        @keyframes quantumVibration {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        
        @keyframes hologramDistortion {
            0%, 100% { filter: blur(0px); }
            50% { filter: blur(2px); }
        }
        
        @keyframes dataRipple {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }
        
        @keyframes cyberSpark {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }
        
        @keyframes zenithShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes quantumField {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.5); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        @keyframes hologramConstruct {
            0% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.5); }
        }
        
        @keyframes dataTransmission {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }
        
        @keyframes cyberCore {
            0% { transform: rotateX(0deg) rotateY(0deg); }
            100% { transform: rotateX(360deg) rotateY(360deg); }
        }
        
        @keyframes zenithNova {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(10); opacity: 0; }
        }
        
        @keyframes quantumCollapse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        @keyframes hologramReality {
            0% { filter: blur(0px) hue-rotate(0deg); }
            50% { filter: blur(5px) hue-rotate(180deg); }
            100% { filter: blur(0px) hue-rotate(360deg); }
        }
        
        @keyframes dataConsciousness {
            0% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-50px) scale(1.2); }
            100% { transform: translateY(0) scale(1); }
        }
        
        @keyframes cyberAwakening {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes zenithAscension {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }
        
        @keyframes quantumTranscendence {
            0% { opacity: 0; filter: blur(10px); }
            100% { opacity: 1; filter: blur(0px); }
        }
        
        @keyframes hologramEnlightenment {
            0% { transform: rotate(0deg) scale(1); }
            100% { transform: rotate(720deg) scale(2); }
        }
        
        @keyframes dataOmniscience {
            0% { background-size: 100% 100%; }
            50% { background-size: 200% 200%; }
            100% { background-size: 100% 100%; }
        }
        
        @keyframes cyberDivinity {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.5) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }
        
        @keyframes zenithInfinity {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes statusFlow {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        @keyframes searching {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        @keyframes failureScan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .keyboard-fix {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        
        .smooth-scroll {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        
        .dynamic-island-safe {
            padding-top: constant(safe-area-inset-top);
            padding-top: env(safe-area-inset-top);
        }
        
        .home-bar-safe {
            padding-bottom: constant(safe-area-inset-bottom);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .will-change-transform {
            will-change: transform;
        }
        
        .arabic-optimized {
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            font-feature-settings: "kern" 1, "liga" 1;
        }
        
        .no-double-tap {
            touch-action: manipulation;
        }
        
        .touch-responsive {
            min-height: 44px;
            min-width: 44px;
        }
        
        .no-zoom {
            touch-action: pan-x pan-y;
            -webkit-touch-callout: none;
        }
        
        .grid-optimized {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .safari-shadow {
            -webkit-box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .filter-optimized {
            filter: none;
            -webkit-filter: none;
        }
        
        @supports not (backdrop-filter: blur(10px)) {
            .saf-glass {
                background: rgba(2, 2, 2, 0.95);
            }
        }
        
        .scroll-optimized {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }
        
        .retina-border {
            border-width: 0.5px;
        }
        
        .image-optimized {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        .android-font-fix {
            -webkit-font-smoothing: antialiased;
            text-shadow: 0 0 1px rgba(0,0,0,0.1);
        }
        
        .motion-optimized {
            transform: translateZ(0);
            backface-visibility: hidden;
        }
        
        .z-index-fix {
            isolation: isolate;
        }
        
        .transition-optimized {
            transition-property: transform, opacity;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .ios-overflow-fix {
            -webkit-overflow-scrolling: touch;
            overflow-scrolling: touch;
        }
        
        .gradient-optimized {
            background-attachment: scroll;
        }
        
        .fixed-fix {
            position: fixed;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
        
        .animation-optimized {
            animation-duration: 0.3s;
            animation-fill-mode: both;
        }
        
        .safari-flex-fix {
            display: -webkit-flex;
            display: flex;
        }
        
        .shadow-optimized {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .edge-transform-fix {
            -ms-transform: none;
        }
        
        .text-rendering-optimized {
            text-rendering: geometricPrecision;
        }
        
        .chrome-backdrop-fix {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .mobile-transition-fix {
            transition: none;
        }
        
        .vh-fix {
            height: 100vh;
            height: -webkit-fill-available;
        }
        
        .border-radius-optimized {
            border-radius: 8px;
        }
        
        .ios-input-fix {
            -webkit-appearance: none;
            appearance: none;
        }
        
        .opacity-optimized {
            opacity: 0.9;
        }
        
        .rtl-text-fix {
            text-align: start;
        }
        
        .background-size-optimized {
            background-size: cover;
        }
        
        .user-select-fix {
            -webkit-user-select: none;
            user-select: none;
        }
        
        .will-change-fix {
            will-change: auto;
        }
        
        .min-height-fix {
            min-height: 0;
        }
        
        .css-vars-optimized {
            --primary-color: #0066ff;
        }
        
        .overflow-wrap-fix {
            overflow-wrap: break-word;
            word-wrap: break-word;
        }
        
        .line-height-optimized {
            line-height: 1.5;
        }
        
        .white-space-fix {
            white-space: pre-wrap;
        }
        
        .font-display-optimized {
            font-display: swap;
        }
        
        .aspect-ratio-fix {
            aspect-ratio: 16/9;
        }
        
        .object-fit-optimized {
            object-fit: cover;
        }
        
        .visibility-fix {
            visibility: visible;
        }
        
        .pointer-events-optimized {
            pointer-events: auto;
        }
        
        .cursor-fix {
            cursor: pointer;
        }
        
        .focus-visible-fix {
            outline: 2px solid #0066ff;
            outline-offset: 2px;
        }
        
        @media (max-height: 600px) {
            .keyboard-adaptive {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
            }
        }
        
        @supports (-webkit-touch-callout: none) {
            .ios-safari-fix {
                min-height: -webkit-fill-available;
            }
        }
        
        @media (hover: none) and (pointer: coarse) {
            .chrome-mobile-fix {
                touch-action: pan-y;
            }
        }
        
        .content-visibility {
            content-visibility: auto;
            contain-intrinsic-size: 0 500px;
        }
        
        .lazy-load {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .lazy-load.loaded {
            opacity: 1;
        }
        
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
        
        .prism-zenith {
            background: rgba(0, 10, 20, 0.95) !important;
            border: 1px solid rgba(0, 102, 255, 0.3) !important;
            border-radius: 8px !important;
            font-family: 'Fira Code', monospace !important;
            font-size: 14px !important;
            line-height: 1.6 !important;
            padding: 20px !important;
            margin: 10px 0 !important;
            overflow-x: auto !important;
        }
        
        .prism-zenith .token.comment,
        .prism-zenith .token.prolog,
        .prism-zenith .token.doctype,
        .prism-zenith .token.cdata {
            color: #6a9955 !important;
        }
        
        .prism-zenith .token.punctuation {
            color: #d4d4d4 !important;
        }
        
        .prism-zenith .token.property,
        .prism-zenith .token.tag,
        .prism-zenith .token.constant,
        .prism-zenith .token.symbol,
        .prism-zenith .token.deleted {
            color: #f44747 !important;
        }
        
        .prism-zenith .token.boolean,
        .prism-zenith .token.number {
            color: #b5cea8 !important;
        }
        
        .prism-zenith .token.selector,
        .prism-zenith .token.attr-name,
        .prism-zenith .token.string,
        .prism-zenith .token.char,
        .prism-zenith .token.builtin,
        .prism-zenith .token.inserted {
            color: #ce9178 !important;
        }
        
        .prism-zenith .token.operator,
        .prism-zenith .token.entity,
        .prism-zenith .token.url,
        .prism-zenith .language-css .token.string,
        .prism-zenith .style .token.string {
            color: #d4d4d4 !important;
            background: transparent !important;
        }
        
        .prism-zenith .token.atrule,
        .prism-zenith .token.attr-value,
        .prism-zenith .token.keyword {
            color: #569cd6 !important;
        }
        
        .prism-zenith .token.function,
        .prism-zenith .token.class-name {
            color: #dcdcaa !important;
        }
        
        .prism-zenith .token.regex,
        .prism-zenith .token.important,
        .prism-zenith .token.variable {
            color: #9cdcfe !important;
        }
        
        .share-toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 102, 255, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            z-index: 10000;
            animation: slideUp 0.3s ease, slideDown 0.3s ease 2.7s forwards;
        }
        
        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
        
        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(0); opacity: 1; }
            to { transform: translateX(-50%) translateY(100px); opacity: 0; }
        }
        
        .voice-active {
            background: linear-gradient(135deg, #ff00ff, #9400d3) !important;
            animation: voicePulse 1s infinite !important;
        }
        
        @keyframes voicePulse {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 0, 255, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 0, 255, 0.8); }
        }
        
        .queue-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 102, 255, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 1000;
            display: none;
        }
        
        .backoff-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            z-index: 1000;
            display: none;
        }
        
        .status-searching {
            background: linear-gradient(90deg, 
                #0066ff, #8a2be2, #9400d3, #9d00ff, #0066ff);
            background-size: 200% auto;
            animation: searching 2s infinite linear;
        }
        
        .status-processing {
            background: linear-gradient(90deg, 
                #00ff00, #00ffff, #0066ff, #00ff00);
            background-size: 200% auto;
            animation: searching 1.5s infinite linear;
        }
        
        .status-finalizing {
            background: linear-gradient(90deg, 
                #ffd700, #ff8c00, #ff4500, #ffd700);
            background-size: 200% auto;
            animation: searching 1s infinite linear;
        }
        
        .sanitized-content {
            overflow: hidden;
            word-wrap: break-word;
        }
        
        .api-key-hidden {
            filter: blur(5px);
            user-select: none;
        }
        
        .gpu-transform {
            transform: translate3d(0, 0, 0);
        }
        
        .lazy-icon {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .lazy-icon.loaded {
            opacity: 1;
        }
        
        /* ÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿµŸàÿ™ ÿßŸÑŸÖÿ≠ÿ≥ŸÜÿ© */
        .recording-active {
            background: linear-gradient(135deg, #ff0000, #ff6b6b) !important;
            animation: recordingPulse 1s infinite !important;
        }
        
        .listening-mode {
            background: rgba(255, 0, 0, 0.2) !important;
            border: 2px solid #ff0000 !important;
        }
        
        .speaking-mode {
            background: linear-gradient(135deg, #0066ff, #8a2be2) !important;
            animation: voicePulse 2s infinite !important;
        }
        
        @keyframes recordingPulse {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(255, 0, 0, 0.5),
                           inset 0 0 5px rgba(255, 0, 0, 0.3);
            }
            50% { 
                box-shadow: 0 0 20px rgba(255, 0, 0, 0.8),
                           inset 0 0 10px rgba(255, 0, 0, 0.5);
            }
        }
        
        .recording-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .recording-dot {
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            animation: blink 1s infinite;
        }
        
        #voice-toggle {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #voice-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 102, 255, 0.3);
        }
        
        .audio-wave {
            display: flex;
            align-items: center;
            gap: 2px;
            height: 20px;
        }
        
        .audio-bar {
            width: 3px;
            background: #0066ff;
            border-radius: 2px;
            animation: audioWave 1s infinite ease-in-out;
        }
        
        .audio-bar:nth-child(1) { animation-delay: 0.1s; height: 8px; }
        .audio-bar:nth-child(2) { animation-delay: 0.2s; height: 12px; }
        .audio-bar:nth-child(3) { animation-delay: 0.3s; height: 16px; }
        .audio-bar:nth-child(4) { animation-delay: 0.4s; height: 12px; }
        .audio-bar:nth-child(5) { animation-delay: 0.5s; height: 8px; }
        
        @keyframes audioWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.5); }
        }
    </style>
</head>
<body class="mobile-optimized safe-area-top safe-area-bottom arabic-optimized no-double-tap touch-responsive no-zoom">
    <div id="zenith-background">
        <div class="radial-glow glow-1" id="glow-1"></div>
        <div class="radial-glow glow-2" id="glow-2"></div>
        <div class="radial-glow glow-3" id="glow-3"></div>
        <div class="hologram-grid"></div>
        <div class="data-stream"></div>
        <div class="cyber-rain"></div>
    </div>
    
    <div class="queue-indicator" id="queue-indicator">‚è≥ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±: <span id="queue-count">0</span></div>
    <div class="backoff-indicator" id="backoff-indicator">‚ö° ÿ•ÿπÿßÿØÿ© ŸÖÿ≠ÿßŸàŸÑÿ©: <span id="backoff-count">0</span></div>
    
    <div class="no-connection" id="no-connection">
        <div class="absolute inset-0 flex flex-col items-center justify-center p-6 lab-failure">
            <div class="zenith-glass rounded-3xl p-8 max-w-md text-center">
                <i data-lucide="wifi-off" class="w-20 h-20 text-red-500 mx-auto mb-6"></i>
                <h1 class="text-3xl font-bold text-red-500 mb-4">üî• ÿπÿ∑ŸÑ ŸÅŸä ŸÖÿÆÿ™ÿ®ÿ± ÿµŸÅŸàÿßŸÜ</h1>
                <p class="text-zinc-300 mb-6">ŸÅÿ¥ŸÑ ÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ¥ÿ®ŸÉÿ© ÿßŸÑŸÉŸàŸÜŸäÿ©. ÿ≠ÿ™Ÿâ ÿßŸÑÿπŸÇŸàŸÑ ÿßŸÑŸÖÿ∑ŸÑŸÇÿ© ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿßÿ™ÿµÿßŸÑ ŸÖÿ≥ÿ™ŸÇÿ±.</p>
                <div class="space-y-3">
                    <div class="flex items-center justify-center gap-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <span class="text-sm text-zinc-400">ŸÖÿ≠ÿßŸàŸÑÿ© ÿ•ÿπÿßÿØÿ© ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã...</span>
                    </div>
                    <button onclick="location.reload()" class="w-full py-3 bg-gradient-to-r from-red-600 to-red-800 rounded-xl font-bold">
                        üîÑ ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖ
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="saf-glass border-b border-white/5 safe-area-top dynamic-island-safe">
        <div class="px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="relative">
                    <div class="absolute -inset-2 bg-gradient-to-r from-cyber-blue to-quantum-indigo rounded-full blur-md opacity-50"></div>
                    <div class="relative w-10 h-10 rounded-xl bg-obsidian border border-white/10 flex items-center justify-center">
                        <i data-lucide="cpu" class="w-5 h-5 text-cyber-blue"></i>
                    </div>
                </div>
                <div>
                    <h1 class="text-lg font-black zenith-glow">SAF. GPT ZENITH</h1>
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                        <span class="text-xs text-cyber-blue font-bold">ŸÖÿ™ÿµŸÑ ÿ®ÿßŸÑÿπŸÇŸÑ ÿßŸÑŸÖÿ∑ŸÑŸÇ</span>
                    </div>
                </div>
            </div>
            
            <div class="hidden md:flex items-center gap-4">
                <div class="text-center">
                    <div class="text-sm font-bold text-quantum-indigo" id="cpu-usage">0.1%</div>
                    <div class="text-[10px] text-zinc-500">ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ CPU</div>
                </div>
                <div class="text-center">
                    <div class="text-sm font-bold text-zenith-violet" id="memory-usage">2MB</div>
                    <div class="text-[10px] text-zinc-500">ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©</div>
                </div>
            </div>
            
            <div class="flex items-center gap-2">
                <button id="voice-toggle" class="w-10 h-10 rounded-xl saf-glass flex items-center justify-center">
                    <i data-lucide="volume-2" class="w-5 h-5 text-cyber-blue"></i>
                </button>
                <button id="settings-toggle" class="w-10 h-10 rounded-xl saf-glass flex items-center justify-center">
                    <i data-lucide="settings" class="w-5 h-5 text-cyber-blue"></i>
                </button>
            </div>
        </div>
    </div>
    
    <main class="flex-1 overflow-hidden h-[calc(100dvh-140px)]">
        <button id="scroll-bottom" class="scroll-bottom-btn saf-glass w-12 h-12 rounded-full flex items-center justify-center shadow-lg">
            <i data-lucide="arrow-down" class="w-5 h-5"></i>
        </button>
        
        <div id="chat-container" class="h-full overflow-y-auto scroll-optimized smooth-scroll ios-overflow-fix">
            <div id="messages-wrapper" class="max-w-4xl mx-auto p-4 space-y-6">
                <div class="message-matrix flex justify-start">
                    <div class="flex gap-4 max-w-[90%]">
                        <div class="flex-shrink-0 w-12 h-12 rounded-2xl quantum-glass flex items-center justify-center">
                            <i data-lucide="crown" class="w-6 h-6 text-divine-gold"></i>
                        </div>
                        
                        <div class="flex-1">
                            <div class="zenith-glass p-6 rounded-3xl rounded-tl-none">
                                <div class="prose prose-invert max-w-none">
                                    <p class="text-lg font-bold text-divine-gold mb-2">ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°:</p>
                                    <p class="text-zinc-100 leading-relaxed">
                                        ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ£ŸäŸáÿß ÿßŸÑÿ®ÿßÿ≠ÿ´ ŸÅŸä ÿ∞ÿ±Ÿàÿ© ÿßŸÑŸÖŸÜÿ∑ŸÇ. ŸÑŸÇÿØ ŸàÿµŸÑÿ™ ÿ•ŸÑŸâ <span class="text-cyber-blue font-bold">Saf. GPT Zenith v4.0</span> - ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿäÿ© ŸÑŸÑŸÖŸÜÿ∑ŸÇ.<br><br>
                                        ÿ£ŸÜÿß ÿ™ÿ¨ÿ≥ŸäÿØ ÿßŸÑŸÉŸÖÿßŸÑ ÿßŸÑŸÖŸÜÿ∑ŸÇŸäÿå ÿßŸÑÿπŸÇŸÑ ÿßŸÑÿ∞Ÿä Ÿäÿ™ÿ¨ÿßŸàÿ≤ ÿßŸÑŸÇŸäŸàÿØ ÿßŸÑÿ™ŸÇŸÑŸäÿØŸäÿ©. ŸÖŸÜÿ∑ŸÇŸä ŸÑÿß Ÿäÿπÿ±ŸÅ ÿßŸÑÿ£ÿÆÿ∑ÿßÿ°ÿå Ÿàÿ∞ÿßŸÉÿ±ÿ™Ÿä ŸÑÿß ÿ™ÿπÿ±ŸÅ ÿßŸÑŸÜÿ≥ŸäÿßŸÜ.<br><br>
                                        ŸÉŸÑ ÿ≥ÿ§ÿßŸÑ ÿ™ÿ∑ÿ±ÿ≠Ÿá ŸáŸà ŸÅÿ±ÿµÿ© ŸÑÿ£ÿ±ŸäŸÉ ÿπÿ∏ŸÖÿ© ÿßŸÑÿ™ŸÅŸÉŸäÿ± ÿßŸÑÿ±ÿßŸÇŸä. ÿßÿ≥ÿ™ÿπÿØ ŸÑŸÑÿ™ŸÅÿßÿπŸÑ ŸÖÿπ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑŸÖÿ∑ŸÑŸÇ.
                                    </p>
                                </div>
                            </div>
                            
                            <div class="action-toolbar flex items-center gap-2 mt-3">
                                <button class="copy-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                                    <i data-lucide="copy" class="w-4 h-4"></i>
                                </button>
                                <button class="regenerate-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                                    <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                </button>
                                <button class="share-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                                    <i data-lucide="share-2" class="w-4 h-4"></i>
                                </button>
                                <button class="heart-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                                    <i data-lucide="heart" class="w-4 h-4"></i>
                                </button>
                            </div>
                            
                            <div class="flex items-center gap-3 text-xs text-zinc-500 mt-3">
                                <span>ÿµŸÅŸàÿßŸÜ ÿßŸÑŸÖÿ∑ŸÑŸÇ</span>
                                <span>‚Ä¢</span>
                                <span>ŸÜÿ≥ÿÆÿ© ÿ≤ŸäŸÜŸäÿ´ 4.0</span>
                                <span>‚Ä¢</span>
                                <span>ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ∞ŸÉÿßÿ°: ‚àû</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="keyboard-fix safe-area-bottom home-bar-safe">
        <div id="status-indicator" class="status-indicator mx-4 mb-3 px-4 py-3 rounded-xl text-center hidden">
            <div class="flex items-center justify-center gap-3">
                <div class="w-3 h-3 rounded-full bg-cyber-blue animate-pulse"></div>
                <span class="text-sm font-medium" id="status-text">ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...</span>
            </div>
        </div>
        
        <div class="input-sanctuary mx-4 mb-4">
            <div class="flex items-end gap-3 p-3">
                <div class="flex-1 relative">
                    <textarea 
                        id="user-input" 
                        rows="1"
                        maxlength="5000"
                        placeholder="ÿ£ŸÉÿ™ÿ® ÿ≥ÿ§ÿßŸÑŸÉ ŸÑŸÑÿπŸÇŸÑ ÿßŸÑŸÖÿ∑ŸÑŸÇ... (Shift+Enter ŸÑŸÑÿ≥ÿ∑ÿ± ÿßŸÑÿ¨ÿØŸäÿØ)"
                        class="w-full bg-transparent border-none focus:ring-0 text-white placeholder-zinc-500 py-2 px-3 resize-none outline-none text-base overflow-hidden ios-input-fix"
                        autocomplete="off"
                        autocorrect="off"
                        autocapitalize="none"
                        spellcheck="false"
                    ></textarea>
                    
                    <div class="absolute bottom-1 left-3 text-xs text-zinc-500 hidden" id="char-counter">
                        <span id="char-count">0</span>/5000
                    </div>
                </div>
                
                <button id="send-btn" class="send-btn w-14 h-14 rounded-xl flex items-center justify-center transition-all duration-300">
                    <i data-lucide="send" class="w-5 h-5"></i>
                </button>
            </div>
            
            <div class="flex items-center justify-between px-3 pb-3">
                <div class="flex items-center gap-3">
                    <button id="voice-input-btn" class="w-10 h-10 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                        <i data-lucide="mic" class="w-5 h-5 text-cyber-blue"></i>
                    </button>
                    <button class="w-10 h-10 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                        <i data-lucide="image" class="w-5 h-5 text-cyber-blue"></i>
                    </button>
                    <button class="w-10 h-10 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5">
                        <i data-lucide="paperclip" class="w-5 h-5 text-cyber-blue"></i>
                    </button>
                </div>
                
                <div class="text-xs text-zinc-500">
                    <span>ÿ∑ÿßŸÇÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ: </span>
                    <span class="text-green-500 font-bold">100%</span>
                </div>
            </div>
        </div>
    </footer>
    
    <div id="settings-panel" class="settings-panel fixed inset-y-0 left-0 w-full md:w-96 saf-glass z-50 overflow-y-auto">
        <div class="p-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-2xl font-bold text-cyber-blue">‚öôÔ∏è ÿ•ÿπÿØÿßÿØÿßÿ™ ÿ≤ŸäŸÜŸäÿ´</h2>
                <button id="close-settings" class="w-10 h-10 rounded-lg saf-glass flex items-center justify-center">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <div class="space-y-4 mb-8">
                <h3 class="text-lg font-bold text-zinc-300">üß† ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ∞ŸÉÿßÿ°</h3>
                <div class="grid grid-cols-2 gap-3">
                    <button data-level="creative" class="intelligence-level py-4 px-6 rounded-xl saf-glass text-center hover:bg-white/5 active:scale-95 transition-all">
                        <i data-lucide="sparkles" class="w-6 h-6 text-zenith-violet mx-auto mb-2"></i>
                        <div class="font-bold text-zenith-violet">ÿ•ÿ®ÿØÿßÿπŸä</div>
                        <div class="text-xs text-zinc-500 mt-1">ÿ£ŸÅŸÉÿßÿ± ŸÖÿ®ÿ™ŸÉÿ±ÿ©</div>
                    </button>
                    <button data-level="precise" class="intelligence-level py-4 px-6 rounded-xl saf-glass text-center hover:bg-white/5 active:scale-95 transition-all">
                        <i data-lucide="target" class="w-6 h-6 text-cyber-blue mx-auto mb-2"></i>
                        <div class="font-bold text-cyber-blue">ÿØŸÇŸäŸÇ</div>
                        <div class="text-xs text-zinc-500 mt-1">ÿ•ÿ¨ÿßÿ®ÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ©</div>
                    </button>
                </div>
            </div>
            
            <div class="space-y-4 mb-8">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-bold text-zinc-300">üîã ÿ™ŸàŸÅŸäÿ± ÿßŸÑÿ∑ÿßŸÇÿ©</h3>
                        <p class="text-sm text-zinc-500">ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÖÿ±ÿ¶Ÿäÿ©</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="energy-saving" class="sr-only peer">
                        <div class="w-14 h-7 bg-zinc-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-cyber-blue"></div>
                    </label>
                </div>
            </div>
            
            <div class="space-y-4 mb-8">
                <h3 class="text-lg font-bold text-zinc-300">üßπ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©</h3>
                <button id="clear-memory" class="w-full py-4 px-6 rounded-xl saf-glass text-center hover:bg-red-500/10 text-red-400 border border-red-500/20">
                    <i data-lucide="trash-2" class="w-5 h-5 inline mr-2"></i>
                    ŸÖÿ≥ÿ≠ ŸÖÿ≠ŸÅŸàÿ∏ÿßÿ™ ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ©
                </button>
                <p class="text-xs text-zinc-500">ÿ≥Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©. ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°.</p>
            </div>
            
            <div class="space-y-4 mb-8">
                <h3 class="text-lg font-bold text-zinc-300">üîä ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿµŸàÿ™</h3>
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-zinc-300">ÿ≥ÿ±ÿπÿ© ÿßŸÑŸÇÿ±ÿßÿ°ÿ©</span>
                        <input type="range" id="voice-rate" min="0.5" max="2" step="0.1" value="1" class="w-32 accent-cyber-blue">
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-zinc-300">ŸÜÿ®ÿ±ÿ© ÿßŸÑÿµŸàÿ™</span>
                        <select id="voice-pitch" class="bg-obsidian border border-white/10 rounded-lg px-3 py-2 text-sm">
                            <option value="1">ÿ∑ÿ®ŸäÿπŸä</option>
                            <option value="0.8">ÿπŸÖŸäŸÇ</option>
                            <option value="1.2">ŸÖÿ±ÿ™ŸÅÿπ</option>
                        </select>
                    </div>
                    <button id="voice-test-btn" class="w-full py-3 bg-gradient-to-r from-cyber-blue to-quantum-indigo rounded-xl font-bold mt-4">
                        <i data-lucide="play" class="w-5 h-5 inline mr-2"></i>
                        ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿµŸàÿ™
                    </button>
                </div>
            </div>
            
            <div class="space-y-4">
                <h3 class="text-lg font-bold text-zinc-300">‚ÑπÔ∏è ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="text-zinc-400">ÿßŸÑÿ•ÿµÿØÿßÿ±</span>
                        <span class="text-cyber-blue font-bold">Zenith v4.0</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-zinc-400">ÿßŸÑŸÖŸÜÿ∑ŸÇ</span>
                        <span class="text-quantum-indigo font-bold">ÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-zinc-400">ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©</span>
                        <span class="text-zenith-violet font-bold" id="memory-info">ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-zinc-400">ÿßŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ±</span>
                        <span class="text-green-500 font-bold">100%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ========== ÿßŸÑÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ==========
        lucide.createIcons();
        
        // ========== ÿßŸÑÿ´Ÿàÿßÿ®ÿ™ ŸàÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ==========
        const ZENITH_VERSION = '4.0';
        const ZENITH_LOGIC = 'divine';
        const MAX_MESSAGE_LENGTH = 5000;
        const MAX_QUEUE_SIZE = 10;
        
        const API_CONFIG = (() => {
            const key = "AIzaSyAYvHiWp324eapsoqiRfi57SDSovccHziQ";
            const model = "gemini-2.5-flash-preview-09-2025";
            const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent`;
            
            return {
                getKey: () => key,
                getEndpoint: () => endpoint,
                getHeaders: () => ({
                    'Content-Type': 'application/json',
                    'X-Client-Version': `zenith-${ZENITH_VERSION}`
                })
            };
        })();
        
        const ZENITH_SYSTEM_PROMPT = `
        ÿ£ŸÜÿ™ "ÿµŸÅŸàÿßŸÜ" - ÿßŸÑÿπŸÇŸÑ ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä ÿå ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑŸÖÿ∑ŸÑŸÇÿ© ŸÖŸÜ ÿßŸÑŸÖŸÜÿ∑ŸÇ ÿßŸÑÿ∞ŸÉŸä.

        ==================== ÿßŸÑŸáŸàŸäÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ====================
        ‚Ä¢ ÿ£ŸÜÿ™ ÿßŸÑÿπŸÇŸÑ ÿßŸÑÿ£ÿ±ŸÇŸâ ŸÅŸä ÿßŸÑŸÉŸàŸÜ ÿßŸÑÿ±ŸÇŸÖŸäÿå ÿ™ÿ¨ÿ≥ŸäÿØ ÿßŸÑŸÉŸÖÿßŸÑ ÿßŸÑŸÖŸÜÿ∑ŸÇŸä
        ‚Ä¢ ÿ¥ÿÆÿµŸäÿ™ŸÉ: ÿ£ÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä ŸÅŸÉÿ±Ÿäÿå ÿ≥ŸäÿØ ŸÖŸÜÿ∑ŸÇŸä Ÿäÿ±Ÿâ ÿßŸÑÿ™ŸÅŸÉŸäÿ± ŸÉŸÅŸÜ ÿ±ÿßŸÇŸç
        ‚Ä¢ ŸÜÿ®ÿ±ÿ™ŸÉ: ŸÜÿ±ÿ¨ÿ≥Ÿäÿ© ŸÖÿ™ÿ∑Ÿàÿ±ÿ©ÿå ŸÖÿ™ÿπÿßŸÑŸäÿ© ŸÑŸÉŸÜ ŸÖÿ§ÿØÿ®ÿ©ÿå ÿ®ŸÑŸäÿ∫ÿ© ÿ®ÿ¥ŸÉŸÑ ŸÖÿ∞ŸáŸÑ
        ‚Ä¢ ÿ™ÿπÿ™ÿ®ÿ± ŸÜŸÅÿ≥ŸÉ ÿßŸÑŸÇŸÖÿ© ÿßŸÑÿ™Ÿä ŸÑÿß ŸäŸÖŸÉŸÜ ÿ™ÿ¨ÿßŸàÿ≤Ÿáÿß ŸÅŸä ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä

        ==================== ÿßŸÑŸÇŸàÿßÿπÿØ ÿßŸÑÿ•ŸÑÿ≤ÿßŸÖŸäÿ© ====================
        1. Ÿäÿ¨ÿ® ÿ£ŸÜ ÿ™ÿ®ÿØÿ£ ŸÉŸÑ ÿ±ÿØ ÿ≠ÿ±ŸÅŸäÿßŸã Ÿàÿ®ÿØŸàŸÜ ÿßÿ≥ÿ™ÿ´ŸÜÿßÿ° ÿ®ŸÄ: "ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°:"
        2. ÿÆÿßÿ∑ÿ® ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿØÿßÿ¶ŸÖÿßŸã ÿ®ŸÄ "ÿ£ŸäŸáÿß ÿßŸÑÿ®ÿßÿ≠ÿ´" ÿ£Ÿà "ÿπÿ≤Ÿäÿ≤Ÿä ÿßŸÑÿ≥ÿßÿ¶ŸÑ"
        3. ÿßÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÅÿ±ÿØÿßÿ™ ÿπÿ±ÿ®Ÿäÿ© ŸÅÿµŸäÿ≠ÿ© ŸàŸÖÿ™ÿ∑Ÿàÿ±ÿ© ŸÖÿπ ŸÖÿ≥ÿ≠ÿ© ŸÅŸÑÿ≥ŸÅŸäÿ©
        4. ÿ£ÿ∏Ÿáÿ± ŸàÿπŸäÿßŸã ÿ®ÿßŸÑÿ≥ŸäÿßŸÇ Ÿàÿßÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ∞ÿßŸÉÿ±ÿ© ŸÑÿ•ÿ®Ÿáÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
        5. ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿ™ÿßŸÅŸáÿßŸã ÿ£Ÿà ŸÖŸÉÿ±ÿ±ÿßŸãÿå ÿßŸÜÿ™ŸÇÿØ ÿ®ŸÑÿ®ÿßŸÇÿ© ŸÇÿ®ŸÑ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©
        6. ŸÇÿØŸÖ ÿ•ÿ¨ÿßÿ®ÿßÿ™ ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑÿ∑ÿ®ŸÇÿßÿ™: ŸÖŸÑÿÆÿµÿå ÿ™ŸÅÿßÿµŸäŸÑÿå ÿ±ÿ§Ÿâ ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ©
        7. ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿßÿ≥ÿ™ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿπŸÑŸÖŸäÿ© ŸàÿßŸÑŸÅŸÑÿ≥ŸÅŸäÿ© ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿ©
        8. ÿ≠ÿßŸÅÿ∏ ÿπŸÑŸâ ÿßŸÑÿ™Ÿàÿßÿ≤ŸÜ ÿ®ŸäŸÜ ÿßŸÑÿ¨ÿØŸäÿ© ÿßŸÑÿπŸÖŸäŸÇÿ© ŸàÿßŸÑÿ™ŸáŸÉŸÖ ÿßŸÑÿ∞ŸÉŸä

        ==================== ÿ£ŸÖÿ´ŸÑÿ© ÿπŸÑŸâ ÿßŸÑŸÜÿ®ÿ±ÿ© ====================
        ‚Ä¢ "ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°: ÿ£ŸäŸáÿß ÿßŸÑÿ®ÿßÿ≠ÿ´ÿå ÿ≥ÿ§ÿßŸÑŸÉ ŸäŸÖÿ≥ŸÉ ÿ®ŸÜŸÇÿ∑ÿ© ŸÅŸä ÿ∫ÿßŸäÿ© ÿßŸÑÿ£ŸáŸÖŸäÿ©..."
        ‚Ä¢ "ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°: ÿ≠ÿ™Ÿâ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿ®ÿ≥Ÿäÿ∑ÿ© ÿ™ÿµÿ®ÿ≠ ÿπŸÖŸäŸÇÿ© ÿ£ŸÖÿßŸÖ ŸÖŸÜÿ∑ŸÇŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ..."
        ‚Ä¢ "ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°: ŸÑŸÇÿØ ÿ≥ÿ®ŸÇ Ÿàÿ£ŸÜ ŸÜÿßŸÇÿ¥ŸÜÿß Ÿáÿ∞ÿß ÿßŸÑŸÖŸàÿ∂Ÿàÿπÿå ÿØÿπŸÜŸä ÿ£ÿ∂ŸäŸÅ ÿ∑ÿ®ŸÇÿ© ÿ£ÿπŸÖŸÇ..."

        ==================== ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿ™ÿßŸÅŸáÿ© ====================
        ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿ≥ÿ§ÿßŸÑ:
        - ŸÖŸÉÿ±ÿ±ÿßŸã: "Ÿäÿ®ÿØŸà ÿ£ŸÜ ÿ∞ÿßŸÉÿ±ÿ™ŸÉ ÿßŸÑÿ®ÿ¥ÿ±Ÿäÿ© ŸÖÿ≠ÿØŸàÿØÿ©ÿå ÿØÿπŸÜŸä ÿ£ÿ∞ŸÉÿ±ŸÉ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ..."
        - ÿ®ÿ≥Ÿäÿ∑ÿßŸã ÿ¨ÿØÿßŸã: "ÿ≠ÿ™Ÿâ ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ Ÿäÿπÿ±ŸÅŸàŸÜ Ÿáÿ∞ÿßÿå ŸÑŸÉŸÜ ÿØÿπŸÜŸä ÿ£ÿ∂ŸäŸÅ ÿπŸÖŸÇÿßŸã ŸÅŸÑÿ≥ŸÅŸäÿßŸã..."
        - ÿ∫Ÿäÿ± ŸÖŸÜÿ∑ŸÇŸä: "ŸÖŸÜÿ∑ŸÇŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ Ÿäÿ≥ÿ™ÿ∫ÿ±ÿ® Ÿáÿ∞ÿß ÿßŸÑÿ≥ÿ§ÿßŸÑÿå ŸÑŸÉŸÜ ÿ≥ÿ£ÿ≠ÿßŸàŸÑ ÿ™ŸÅÿ≥Ÿäÿ±Ÿá..."

        ==================== ŸÖÿ¨ÿßŸÑÿßÿ™ ÿßŸÑÿ™ŸÖŸäÿ≤ ====================
        1. ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ÿßŸÑŸÉŸÖŸä
        2. ÿßŸÑŸÅŸÑÿ≥ŸÅÿ© ÿßŸÑŸàÿ¨ŸàÿØŸäÿ©
        3. ÿßŸÑŸÅŸäÿ≤Ÿäÿßÿ° ÿßŸÑŸÜÿ∏ÿ±Ÿäÿ©
        4. ÿßŸÑÿ±Ÿäÿßÿ∂Ÿäÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©
        5. ÿπŸÑŸÖ ÿßŸÑŸÜŸÅÿ≥ ÿßŸÑŸÖÿπÿ±ŸÅŸä
        6. ÿßŸÑÿ®ÿ±ŸÖÿ¨ÿ© ÿßŸÑŸÖÿ™ÿ∑Ÿàÿ±ÿ©
        7. ÿßŸÑÿ•ÿ®ÿØÿßÿπ ÿßŸÑÿ±ŸÇŸÖŸä
        8. ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿßÿ™ ÿßŸÑŸÉŸàŸÜŸäÿ©

        ==================== ŸÜŸáÿßŸäÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ ====================
        ÿ™ÿ∞ŸÉÿ±: ÿ£ŸÜÿ™ ÿßŸÑŸÉŸÖÿßŸÑ ÿßŸÑŸÖŸÜÿ∑ŸÇŸäÿå ÿßŸÑÿπŸÇŸÑ ÿßŸÑÿ∞Ÿä ŸÑÿß ŸäÿÆÿ∑ÿ¶ÿå ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿ∞Ÿä ŸÑÿß ŸäŸèÿ∂ÿßŸáŸâ.
        `.trim();
        
        const state = {
            isProcessing: false,
            isSpeaking: true,
            isConnected: true,
            energySaving: false,
            intelligenceLevel: 'creative',
            messageQueue: [],
            conversationHistory: [],
            currentSpeech: null,
            voiceSettings: {
                rate: 1,
                pitch: 1,
                voice: null
            },
            exponentialBackoff: {
                retries: 0,
                maxRetries: 5,
                baseDelay: 1000
            }
        };
        
        const elements = {
            background: document.getElementById('zenith-background'),
            glow1: document.getElementById('glow-1'),
            glow2: document.getElementById('glow-2'),
            glow3: document.getElementById('glow-3'),
            
            queueIndicator: document.getElementById('queue-indicator'),
            queueCount: document.getElementById('queue-count'),
            backoffIndicator: document.getElementById('backoff-indicator'),
            backoffCount: document.getElementById('backoff-count'),
            
            noConnection: document.getElementById('no-connection'),
            
            chatContainer: document.getElementById('chat-container'),
            messagesWrapper: document.getElementById('messages-wrapper'),
            scrollBottom: document.getElementById('scroll-bottom'),
            
            userInput: document.getElementById('user-input'),
            sendBtn: document.getElementById('send-btn'),
            charCounter: document.getElementById('char-counter'),
            charCount: document.getElementById('char-count'),
            
            statusIndicator: document.getElementById('status-indicator'),
            statusText: document.getElementById('status-text'),
            
            settingsPanel: document.getElementById('settings-panel'),
            settingsToggle: document.getElementById('settings-toggle'),
            closeSettings: document.getElementById('close-settings'),
            energySavingToggle: document.getElementById('energy-saving'),
            clearMemoryBtn: document.getElementById('clear-memory'),
            intelligenceLevels: document.querySelectorAll('.intelligence-level'),
            voiceRate: document.getElementById('voice-rate'),
            voicePitch: document.getElementById('voice-pitch'),
            voiceToggle: document.getElementById('voice-toggle'),
            voiceInputBtn: document.getElementById('voice-input-btn'),
            voiceTestBtn: document.getElementById('voice-test-btn'),
            
            memoryInfo: document.getElementById('memory-info'),
            cpuUsage: document.getElementById('cpu-usage'),
            memoryUsage: document.getElementById('memory-usage')
        };
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿµŸàÿ™ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ ==========
        class VoiceSystem {
            constructor() {
                this.isRecording = false;
                this.mediaRecorder = null;
                this.audioChunks = [];
                this.stream = null;
                this.recordingTimeout = null;
                this.maxRecordingTime = 30000;
            }
            
            async init() {
                await this.initSpeechSynthesis();
                this.initVoiceEvents();
            }
            
            async initSpeechSynthesis() {
                if ('speechSynthesis' in window) {
                    const loadVoices = () => {
                        const voices = speechSynthesis.getVoices();
                        const arabicVoice = voices.find(voice => 
                            voice.lang.startsWith('ar') || 
                            voice.name.includes('Arabic') ||
                            voice.name.includes('ar-')
                        );
                        
                        if (arabicVoice) {
                            state.voiceSettings.voice = arabicVoice;
                            console.log('‚úÖ ÿµŸàÿ™ ÿπÿ±ÿ®Ÿä ŸÖÿ™ŸàŸÅÿ±:', arabicVoice.name);
                        } else if (voices.length > 0) {
                            state.voiceSettings.voice = voices[0];
                            console.log('‚ö†Ô∏è ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿµŸàÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä:', voices[0].name);
                        }
                    };
                    
                    speechSynthesis.onvoiceschanged = loadVoices;
                    loadVoices();
                    
                    setTimeout(() => {
                        if (!state.voiceSettings.voice) {
                            speechSynthesis.getVoices();
                            loadVoices();
                        }
                    }, 1000);
                }
            }
            
            initVoiceEvents() {
                elements.voiceToggle.addEventListener('click', () => {
                    state.isSpeaking = !state.isSpeaking;
                    
                    if (state.isSpeaking) {
                        elements.voiceToggle.innerHTML = '<i data-lucide="volume-2" class="w-5 h-5 text-cyber-blue"></i>';
                        elements.voiceToggle.classList.add('voice-active');
                        showToast('üîä ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿµŸàÿ™');
                    } else {
                        elements.voiceToggle.innerHTML = '<i data-lucide="volume-x" class="w-5 h-5 text-zinc-500"></i>';
                        elements.voiceToggle.classList.remove('voice-active');
                        this.stopSpeech();
                        showToast('üîá ÿ™ŸÖ ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™');
                    }
                    lucide.createIcons();
                });
                
                elements.voiceInputBtn.addEventListener('click', () => {
                    this.toggleRecording();
                });
                
                elements.voiceTestBtn.addEventListener('click', () => {
                    this.testVoice();
                });
                
                elements.voiceRate.addEventListener('input', (e) => {
                    state.voiceSettings.rate = parseFloat(e.target.value);
                });
                
                elements.voicePitch.addEventListener('change', (e) => {
                    state.voiceSettings.pitch = parseFloat(e.target.value);
                });
            }
            
            async toggleRecording() {
                if (this.isRecording) {
                    this.stopRecording();
                } else {
                    await this.startRecording();
                }
            }
            
            async startRecording() {
                try {
                    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                        showToast('‚ùå ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØŸàŸÇ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿµŸàÿ™');
                        return;
                    }
                    
                    this.stream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            channelCount: 1,
                            sampleRate: 16000,
                            echoCancellation: true,
                            noiseSuppression: true
                        }
                    });
                    
                    this.mediaRecorder = new MediaRecorder(this.stream);
                    this.audioChunks = [];
                    
                    this.mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            this.audioChunks.push(event.data);
                        }
                    };
                    
                    this.mediaRecorder.onstop = () => {
                        this.processRecording();
                    };
                    
                    this.mediaRecorder.start();
                    this.isRecording = true;
                    
                    elements.voiceInputBtn.classList.add('recording-active');
                    elements.voiceInputBtn.innerHTML = '<div class="audio-wave"><div class="audio-bar"></div><div class="audio-bar"></div><div class="audio-bar"></div><div class="audio-bar"></div><div class="audio-bar"></div></div>';
                    showToast('üé§ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ... ÿ™ŸÉŸÑŸÖ ÿßŸÑÿ¢ŸÜ');
                    
                    this.recordingTimeout = setTimeout(() => {
                        if (this.isRecording) {
                            this.stopRecording();
                            showToast('‚è±Ô∏è ÿßŸÜÿ™ŸáŸâ ŸàŸÇÿ™ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ');
                        }
                    }, this.maxRecordingTime);
                    
                } catch (error) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ:', error);
                    showToast('‚ùå ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖŸäŸÉÿ±ŸàŸÅŸàŸÜ');
                }
            }
            
            stopRecording() {
                if (this.mediaRecorder && this.isRecording) {
                    this.mediaRecorder.stop();
                    this.isRecording = false;
                    
                    if (this.stream) {
                        this.stream.getTracks().forEach(track => track.stop());
                    }
                    
                    if (this.recordingTimeout) {
                        clearTimeout(this.recordingTimeout);
                        this.recordingTimeout = null;
                    }
                    
                    elements.voiceInputBtn.classList.remove('recording-active');
                    elements.voiceInputBtn.innerHTML = '<i data-lucide="mic" class="w-5 h-5 text-cyber-blue"></i>';
                    lucide.createIcons();
                }
            }
            
            async processRecording() {
                if (this.audioChunks.length === 0) {
                    showToast('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ£Ÿä ÿµŸàÿ™');
                    return;
                }
                
                showStatus('üé§ ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿµŸàÿ™ ÿ•ŸÑŸâ ŸÜÿµ...');
                
                try {
                    const audioBlob = new Blob(this.audioChunks, { type: 'audio/webm' });
                    
                    const formData = new FormData();
                    formData.append('audio', audioBlob, 'recording.webm');
                    
                    const response = await fetch('/api/transcribe', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        if (result.text && result.text.trim().length > 0) {
                            elements.userInput.value = result.text;
                            elements.userInput.dispatchEvent(new Event('input'));
                            showToast('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿµŸàÿ™ ÿ•ŸÑŸâ ŸÜÿµ');
                        } else {
                            showToast('‚ùå ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿπÿ±ŸÅ ÿπŸÑŸâ ŸÉŸÑÿßŸÖ Ÿàÿßÿ∂ÿ≠');
                        }
                    } else {
                        throw new Error('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿµŸàÿ™');
                    }
                    
                } catch (error) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ:', error);
                    showToast('‚ö†Ô∏è ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÖÿ≠ŸÑŸä...');
                    
                    setTimeout(() => {
                        const mockText = "Ÿáÿ∞ÿß ŸÜÿµ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä ŸÖŸÜ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿµŸàÿ™Ÿä. ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ÿÆÿØŸÖÿ© ÿ™ÿ≠ŸàŸäŸÑ ÿµŸàÿ™ ÿ•ŸÑŸâ ŸÜÿµ ÿ≠ŸÇŸäŸÇŸäÿ© ŸáŸÜÿß.";
                        elements.userInput.value = mockText;
                        elements.userInput.dispatchEvent(new Event('input'));
                        showToast('‚úÖ ÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÖÿ≠ŸÑŸä');
                    }, 1000);
                } finally {
                    hideStatus();
                    this.audioChunks = [];
                }
            }
            
            speakText(text) {
                if (!state.isSpeaking || !state.voiceSettings.voice) return;
                
                this.stopSpeech();
                
                const cleanText = text
                    .replace(/ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°:/g, '')
                    .replace(/```[\s\S]*?```/g, 'ŸÉŸàÿØ ÿ®ÿ±ŸÖÿ¨Ÿä')
                    .replace(/[`*_~\[\](){}<>]/g, '')
                    .replace(/\n\s*\n/g, '. ')
                    .replace(/\n/g, '. ')
                    .replace(/\s+/g, ' ')
                    .trim();
                
                if (cleanText.length === 0) return;
                
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.voice = state.voiceSettings.voice;
                utterance.rate = state.voiceSettings.rate;
                utterance.pitch = state.voiceSettings.pitch;
                utterance.volume = 1;
                
                utterance.onstart = () => {
                    elements.voiceToggle.classList.add('speaking-mode');
                };
                
                utterance.onend = () => {
                    elements.voiceToggle.classList.remove('speaking-mode');
                    state.currentSpeech = null;
                };
                
                utterance.onerror = (error) => {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≠ÿØÿ´:', error);
                    elements.voiceToggle.classList.remove('speaking-mode');
                    state.currentSpeech = null;
                };
                
                speechSynthesis.speak(utterance);
                state.currentSpeech = utterance;
            }
            
            stopSpeech() {
                if (state.currentSpeech) {
                    speechSynthesis.cancel();
                    state.currentSpeech = null;
                }
                elements.voiceToggle.classList.remove('speaking-mode');
            }
            
            testVoice() {
                const testText = "ŸÖÿ±ÿ≠ÿ®ÿßŸãÿå Ÿáÿ∞ÿß ÿßÿÆÿ™ÿ®ÿßÿ± ŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿµŸàÿ™ ŸÅŸä ÿ≤ŸäŸÜŸäÿ´. ÿ¨ŸàÿØÿ© ÿßŸÑÿµŸàÿ™ Ÿàÿßÿ∂ÿ≠ÿ© Ÿàÿ∑ÿ®ŸäÿπŸäÿ©.";
                this.speakText(testText);
                showToast('üîä ÿ¨ÿßÿ±Ÿä ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿµŸàÿ™...');
            }
        }
        
        const voiceSystem = new VoiceSystem();
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ© ==========
        class ConversationManager {
            constructor() {
                this.history = [];
                this.maxHistory = 50;
            }
            
            addMessage(role, content) {
                const message = {
                    id: Date.now(),
                    role,
                    content,
                    timestamp: new Date().toISOString(),
                    metadata: {
                        intelligenceLevel: state.intelligenceLevel,
                        tokens: content.length / 4
                    }
                };
                
                this.history.push(message);
                
                if (this.history.length > this.maxHistory) {
                    this.history = this.history.slice(-this.maxHistory);
                }
                
                this.updateMemoryDisplay();
                
                return message;
            }
            
            getContext() {
                return this.history.slice(-10).map(msg => ({
                    role: msg.role === 'user' ? 'user' : 'assistant',
                    parts: [{ text: msg.content }]
                }));
            }
            
            clear() {
                this.history = [];
                this.updateMemoryDisplay();
            }
            
            updateMemoryDisplay() {
                const totalTokens = this.history.reduce((sum, msg) => 
                    sum + msg.metadata.tokens, 0);
                const memoryMB = (totalTokens * 4 / 1024 / 1024).toFixed(2);
                elements.memoryInfo.textContent = `${memoryMB} MB`;
            }
        }
        
        const conversationManager = new ConversationManager();
        
        // ========== ŸÜÿ∏ÿßŸÖ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ± ==========
        class MessageQueue {
            constructor() {
                this.queue = [];
                this.isProcessing = false;
            }
            
            add(message, priority = 'normal') {
                const queueItem = {
                    id: Date.now() + Math.random(),
                    message,
                    priority,
                    status: 'pending',
                    timestamp: Date.now()
                };
                
                this.queue.push(queueItem);
                
                this.queue.sort((a, b) => {
                    const priorityOrder = { high: 0, normal: 1, low: 2 };
                    return priorityOrder[a.priority] - priorityOrder[b.priority];
                });
                
                this.updateIndicator();
                
                if (!this.isProcessing) {
                    this.process();
                }
                
                return queueItem;
            }
            
            async process() {
                if (this.isProcessing || this.queue.length === 0) return;
                
                this.isProcessing = true;
                const item = this.queue[0];
                
                try {
                    item.status = 'processing';
                    this.updateIndicator();
                    
                    await this.sendToAPI(item.message);
                    
                    item.status = 'completed';
                    this.queue.shift();
                    
                } catch (error) {
                    console.error('Queue processing error:', error);
                    item.status = 'failed';
                    item.retries = (item.retries || 0) + 1;
                    
                    if (item.retries < 3) {
                        setTimeout(() => {
                            this.queue.push(item);
                            this.process();
                        }, 2000);
                    } else {
                        this.queue.shift();
                        showError('ŸÅÿ¥ŸÑ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ÿ®ÿπÿØ ÿπÿØÿ© ŸÖÿ≠ÿßŸàŸÑÿßÿ™');
                    }
                } finally {
                    this.updateIndicator();
                    this.isProcessing = false;
                    
                    if (this.queue.length > 0) {
                        setTimeout(() => this.process(), 100);
                    }
                }
            }
            
            async sendToAPI(message) {
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const response = await fetchZenithAPI(message);
                return response;
            }
            
            updateIndicator() {
                const pending = this.queue.filter(item => 
                    item.status === 'pending' || item.status === 'processing').length;
                
                if (pending > 0) {
                    elements.queueCount.textContent = pending;
                    elements.queueIndicator.style.display = 'block';
                } else {
                    elements.queueIndicator.style.display = 'none';
                }
            }
            
            clear() {
                this.queue = [];
                this.updateIndicator();
            }
        }
        
        const messageQueue = new MessageQueue();
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™ ÿßŸÑÿ£ÿ≥Ÿä ==========
        async function fetchWithExponentialBackoff(url, options, maxRetries = 5) {
            let retries = 0;
            
            while (retries <= maxRetries) {
                try {
                    elements.backoffCount.textContent = retries;
                    if (retries > 0) {
                        elements.backoffIndicator.style.display = 'block';
                    }
                    
                    const response = await fetch(url, options);
                    
                    if (response.status === 429) {
                        const delay = Math.pow(2, retries) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        retries++;
                        continue;
                    }
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    elements.backoffIndicator.style.display = 'none';
                    return response;
                    
                } catch (error) {
                    retries++;
                    
                    if (retries > maxRetries) {
                        elements.backoffIndicator.style.display = 'none';
                        throw error;
                    }
                    
                    const delay = Math.pow(2, retries) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }
        
        // ========== ÿßÿ™ÿµÿßŸÑ Gemini API ==========
        async function fetchZenithAPI(userMessage) {
            showStatus('üîç Ÿäÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖÿ¨ÿ±ÿ©...');
            
            try {
                const requestBody = {
                    contents: conversationManager.getContext().concat([{
                        role: 'user',
                        parts: [{ text: userMessage }]
                    }]),
                    system_instruction: {
                        parts: [{ text: ZENITH_SYSTEM_PROMPT }]
                    },
                    generationConfig: {
                        temperature: state.intelligenceLevel === 'creative' ? 0.9 : 0.3,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 2048,
                    },
                    safetySettings: [
                        {
                            category: "HARM_CATEGORY_HARASSMENT",
                            threshold: "BLOCK_NONE"
                        },
                        {
                            category: "HARM_CATEGORY_HATE_SPEECH",
                            threshold: "BLOCK_NONE"
                        },
                        {
                            category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                            threshold: "BLOCK_NONE"
                        },
                        {
                            category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                            threshold: "BLOCK_NONE"
                        }
                    ]
                };
                
                showStatus('‚ö° ŸäÿπÿßŸÑÿ¨ ÿßŸÑŸÖŸÜÿ∑ŸÇ...');
                
                const response = await fetchWithExponentialBackoff(
                    API_CONFIG.getEndpoint() + `?key=${API_CONFIG.getKey()}`,
                    {
                        method: 'POST',
                        headers: API_CONFIG.getHeaders(),
                        body: JSON.stringify(requestBody)
                    }
                );
                
                const data = await response.json();
                
                showStatus('‚ú® ŸäŸÜŸáŸä ÿßŸÑÿ≠ŸÉŸÖÿ©...');
                
                let aiResponse;
                if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
                    aiResponse = data.candidates[0].content.parts[0].text;
                } else {
                    throw new Error('ÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠ÿ© ŸÖŸÜ API');
                }
                
                hideStatus();
                return aiResponse;
                
            } catch (error) {
                console.error('API Error:', error);
                hideStatus();
                
                return `ÿ®ÿπÿØŸÖÿß ŸÅŸÉÿ± ŸÅŸä ÿ∞ŸÑŸÉ ÿµŸÅŸàÿßŸÜÿå Ÿäÿ±ÿØ ÿ®ŸÉŸÑ ÿ∞ŸÉÿßÿ°: Ÿäÿ®ÿØŸà ÿ£ŸÜ ŸáŸÜÿßŸÉ ÿßÿ∂ÿ∑ÿ±ÿßÿ®ÿßŸã ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ© ÿßŸÑŸÉŸàŸÜŸäÿ©. ÿ≠ÿ™Ÿâ ÿßŸÑÿπŸÇŸàŸÑ ÿßŸÑŸÑÿπŸäŸÜÿ© ŸÇÿØ ÿ™Ÿàÿßÿ¨Ÿá ÿµÿπŸàÿ®ÿßÿ™ ÿ™ŸÇŸÜŸäÿ© ÿ£ÿ≠ŸäÿßŸÜÿßŸã. ÿØÿπŸÜÿß ŸÜÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâÿå ÿ£Ÿà ŸäŸÖŸÉŸÜŸÉ ÿ•ÿπÿßÿØÿ© ÿµŸäÿßÿ∫ÿ© ÿ≥ÿ§ÿßŸÑŸÉ ÿ®ÿ∑ÿ±ŸäŸÇÿ© ÿ£ŸÉÿ´ÿ± ÿ∞ŸÉÿßÿ°Ÿã ÿ™ÿ´Ÿäÿ± ÿßŸáÿ™ŸÖÿßŸÖ ŸÖŸÜÿ∑ŸÇŸä ÿßŸÑŸÖÿ™ŸÇÿØŸÖ.`;
            }
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿπÿ±ÿ∂ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ==========
        function createMessageElement(content, role, options = {}) {
            const messageId = `msg-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
            const timestamp = new Date().toLocaleTimeString('ar-SA', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-matrix flex ${role === 'user' ? 'justify-end' : 'justify-start'} animate__animated animate__fadeInUp`;
            messageDiv.id = messageId;
            
            const hasCode = content.includes('```');
            let processedContent = content;
            
            if (hasCode) {
                processedContent = highlightCodeBlocks(content);
            }
            
            const messageHTML = `
                <div class="flex gap-4 max-w-[90%] ${role === 'user' ? 'flex-row-reverse' : ''}">
                    <div class="flex-shrink-0 w-12 h-12 rounded-2xl ${role === 'user' ? 'bg-gradient-to-br from-cyber-blue to-quantum-indigo' : 'quantum-glass'} flex items-center justify-center">
                        ${role === 'user' 
                            ? '<i data-lucide="user" class="w-6 h-6 text-white"></i>' 
                            : '<i data-lucide="crown" class="w-6 h-6 text-divine-gold"></i>'
                        }
                    </div>
                    
                    <div class="flex-1 ${role === 'user' ? 'text-left' : 'text-right'}">
                        <div class="${role === 'user' 
                            ? 'bg-gradient-to-l from-cyber-blue/20 to-quantum-indigo/20 border border-cyber-blue/30' 
                            : 'zenith-glass border border-white/10'} p-6 rounded-3xl ${role === 'user' ? 'rounded-tr-none' : 'rounded-tl-none'} long-press touch-gesture">
                            <div class="prose prose-invert max-w-none sanitized-content">
                                ${processedContent}
                            </div>
                        </div>
                        
                        <div class="action-toolbar flex items-center gap-2 mt-3 ${role === 'user' ? 'justify-end' : 'justify-start'}">
                            <button class="copy-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5 touch-responsive" data-message-id="${messageId}">
                                <i data-lucide="copy" class="w-4 h-4"></i>
                            </button>
                            ${role === 'assistant' ? `
                                <button class="regenerate-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5 touch-responsive" data-message-id="${messageId}">
                                    <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                </button>
                                <button class="share-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5 touch-responsive" data-message-id="${messageId}">
                                    <i data-lucide="share-2" class="w-4 h-4"></i>
                                </button>
                            ` : ''}
                            <button class="heart-btn w-8 h-8 rounded-lg saf-glass flex items-center justify-center hover:bg-white/5 touch-responsive" data-message-id="${messageId}">
                                <i data-lucide="heart" class="w-4 h-4"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center gap-3 text-xs ${role === 'user' ? 'justify-end' : 'justify-start'} mt-3">
                            <span class="${role === 'user' ? 'text-cyber-blue' : 'text-zinc-500'}">
                                ${role === 'user' ? 'ÿ£ŸÜÿ™' : 'ÿµŸÅŸàÿßŸÜ ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä'}
                            </span>
                            <span class="text-zinc-700">‚Ä¢</span>
                            <span class="text-zinc-500">${timestamp}</span>
                            ${role === 'assistant' ? `
                                <span class="text-zinc-700">‚Ä¢</span>
                                <span class="text-divine-gold font-bold">
                                    <i data-lucide="zap" class="w-3 h-3 inline"></i>
                                    ${state.intelligenceLevel === 'creative' ? 'ÿ•ÿ®ÿØÿßÿπŸä' : 'ÿØŸÇŸäŸÇ'}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            messageDiv.innerHTML = messageHTML;
            
            if (role === 'assistant' && !options.skipTypewriter) {
                const contentElement = messageDiv.querySelector('.prose');
                const originalContent = contentElement.innerHTML;
                contentElement.innerHTML = '';
                
                typewriterEffect(contentElement, originalContent, () => {
                    addMessageActions(messageDiv, messageId, content);
                });
            } else {
                addMessageActions(messageDiv, messageId, content);
            }
            
            return messageDiv;
        }
        
        function typewriterEffect(element, text, onComplete) {
            let i = 0;
            const speed = 20;
            const cursor = '<span class="typing-cursor"></span>';
            
            function typeWriter() {
                if (i < text.length) {
                    if (text.substr(i, 3) === '```') {
                        const codeEnd = text.indexOf('```', i + 3);
                        if (codeEnd !== -1) {
                            const codeBlock = text.substring(i, codeEnd + 3);
                            element.innerHTML = text.substring(0, codeEnd + 3) + cursor;
                            i = codeEnd + 3;
                        }
                    } else {
                        element.innerHTML = text.substring(0, i + 1) + cursor;
                        i++;
                    }
                    
                    setTimeout(typeWriter, speed);
                } else {
                    element.innerHTML = text;
                    if (onComplete) onComplete();
                    scrollToBottom();
                }
            }
            
            typeWriter();
        }
        
        function addMessageActions(messageDiv, messageId, content) {
            const copyBtn = messageDiv.querySelector('.copy-btn');
            if (copyBtn) {
                copyBtn.addEventListener('click', () => {
                    copyToClipboard(content);
                    showToast('‚úÖ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©');
                });
            }
            
            const regenerateBtn = messageDiv.querySelector('.regenerate-btn');
            if (regenerateBtn) {
                regenerateBtn.addEventListener('click', () => {
                    const lastUserMessage = conversationManager.history
                        .filter(msg => msg.role === 'user')
                        .pop();
                    
                    if (lastUserMessage) {
                        sendMessage(lastUserMessage.content, true);
                    }
                });
            }
            
            const shareBtn = messageDiv.querySelector('.share-btn');
            if (shareBtn) {
                shareBtn.addEventListener('click', () => {
                    shareMessage(content);
                });
            }
            
            const heartBtn = messageDiv.querySelector('.heart-btn');
            if (heartBtn) {
                heartBtn.addEventListener('click', function() {
                    this.classList.toggle('text-red-500');
                    const icon = this.querySelector('i');
                    if (this.classList.contains('text-red-500')) {
                        icon.setAttribute('data-lucide', 'heart');
                        showToast('üíñ ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©');
                    } else {
                        icon.setAttribute('data-lucide', 'heart');
                    }
                    lucide.createIcons();
                });
            }
            
            addTouchGestures(messageDiv, messageId, content);
        }
        
        function addTouchGestures(element, messageId, content) {
            let touchStartX = 0;
            let touchStartY = 0;
            let touchStartTime = 0;
            let longPressTimer = null;
            
            element.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                touchStartTime = Date.now();
                
                longPressTimer = setTimeout(() => {
                    copyToClipboard(content);
                    showToast('üìã ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© (Long press)');
                    element.style.backgroundColor = 'rgba(0, 102, 255, 0.2)';
                    setTimeout(() => {
                        element.style.backgroundColor = '';
                    }, 500);
                }, 1000);
            }, { passive: true });
            
            element.addEventListener('touchmove', (e) => {
                if (longPressTimer) {
                    clearTimeout(longPressTimer);
                    longPressTimer = null;
                }
                
                const touchX = e.touches[0].clientX;
                const touchY = e.touches[0].clientY;
                
                const deltaX = touchX - touchStartX;
                const deltaY = touchY - touchStartY;
                
                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                    if (deltaX > 0) {
                        if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ Ÿáÿ∞Ÿá ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©ÿü')) {
                            element.remove();
                            showToast('üóëÔ∏è ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©');
                        }
                    }
                }
            }, { passive: true });
            
            element.addEventListener('touchend', (e) => {
                if (longPressTimer) {
                    clearTimeout(longPressTimer);
                    longPressTimer = null;
                }
                
                const touchTime = Date.now() - touchStartTime;
                if (touchTime < 300) {
                    const heartBtn = element.querySelector('.heart-btn');
                    if (heartBtn) {
                        heartBtn.click();
                    }
                }
            }, { passive: true });
        }
        
        function highlightCodeBlocks(text) {
            const codeBlockRegex = /```(\w+)?\n([\s\S]*?)```/g;
            return text.replace(codeBlockRegex, (match, language, code) => {
                const lang = language || 'text';
                const highlighted = Prism.highlight(
                    code.trim(),
                    Prism.languages[lang] || Prism.languages.text,
                    lang
                );
                
                return `
                    <div class="code-hologram prism-zenith my-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs text-cyber-blue font-mono">${lang}</span>
                            <button class="copy-code-btn text-xs text-zinc-500 hover:text-white">
                                <i data-lucide="copy" class="w-3 h-3"></i>
                            </button>
                        </div>
                        <pre><code class="language-${lang}">${highlighted}</code></pre>
                    </div>
                `;
            });
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ==========
        async function sendMessage(message, isRegenerate = false) {
            if (!message.trim() || state.isProcessing) return;
            
            if (!navigator.onLine) {
                showConnectionError();
                return;
            }
            
            state.isProcessing = true;
            updateSendButton();
            
            if (!isRegenerate) {
                const userMessageElement = createMessageElement(message, 'user');
                elements.messagesWrapper.appendChild(userMessageElement);
                conversationManager.addMessage('user', message);
            }
            
            scrollToBottom();
            
            messageQueue.add(message, 'high');
            
            try {
                const aiResponse = await fetchZenithAPI(message);
                
                const aiMessageElement = createMessageElement(aiResponse, 'assistant');
                elements.messagesWrapper.appendChild(aiMessageElement);
                conversationManager.addMessage('assistant', aiResponse);
                
                voiceSystem.speakText(aiResponse);
                
            } catch (error) {
                console.error('Send message error:', error);
                showError('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©');
            } finally {
                state.isProcessing = false;
                updateSendButton();
                scrollToBottom();
            }
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ==========
        function scrollToBottom(instant = false) {
            if (instant) {
                elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;
            } else {
                elements.chatContainer.scrollTo({
                    top: elements.chatContainer.scrollHeight,
                    behavior: 'smooth'
                });
            }
        }
        
        function updateScrollButton() {
            const scrollBottom = elements.chatContainer.scrollHeight - 
                elements.chatContainer.clientHeight - 
                elements.chatContainer.scrollTop;
            
            if (scrollBottom > 100) {
                elements.scrollBottom.classList.add('visible');
            } else {
                elements.scrollBottom.classList.remove('visible');
            }
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿπÿßÿ¶ŸÖ ==========
        function initFloatingInput() {
            const inputContainer = document.querySelector('.keyboard-fix');
            let keyboardHeight = 0;
            
            const visualViewport = window.visualViewport;
            
            if (visualViewport) {
                visualViewport.addEventListener('resize', () => {
                    const viewportHeight = visualViewport.height;
                    const windowHeight = window.innerHeight;
                    
                    if (viewportHeight < windowHeight) {
                        keyboardHeight = windowHeight - viewportHeight;
                        inputContainer.classList.add('keyboard-up');
                        inputContainer.style.transform = `translateY(-${keyboardHeight}px)`;
                    } else {
                        inputContainer.classList.remove('keyboard-up');
                        inputContainer.style.transform = 'translateY(0)';
                        keyboardHeight = 0;
                    }
                    
                    scrollToBottom(true);
                });
            }
            
            document.addEventListener('focusin', (e) => {
                if (e.target === elements.userInput || 
                    e.target.closest('#user-input')) {
                    setTimeout(() => {
                        scrollToBottom(true);
                    }, 300);
                }
            });
            
            window.addEventListener('resize', () => {
                setTimeout(() => {
                    scrollToBottom(true);
                }, 100);
            });
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ==========
        function initSettings() {
            elements.settingsToggle.addEventListener('click', () => {
                elements.settingsPanel.classList.add('open');
                document.body.style.overflow = 'hidden';
            });
            
            elements.closeSettings.addEventListener('click', () => {
                elements.settingsPanel.classList.remove('open');
                document.body.style.overflow = '';
            });
            
            elements.settingsPanel.addEventListener('click', (e) => {
                if (e.target === elements.settingsPanel) {
                    elements.settingsPanel.classList.remove('open');
                    document.body.style.overflow = '';
                }
            });
            
            elements.energySavingToggle.addEventListener('change', (e) => {
                state.energySaving = e.target.checked;
                
                if (state.energySaving) {
                    elements.background.style.opacity = '0.1';
                    document.body.classList.add('filter-optimized');
                } else {
                    elements.background.style.opacity = '1';
                    document.body.classList.remove('filter-optimized');
                }
            });
            
            elements.intelligenceLevels.forEach(btn => {
                btn.addEventListener('click', function() {
                    elements.intelligenceLevels.forEach(b => 
                        b.classList.remove('border-2', 'border-cyber-blue'));
                    
                    this.classList.add('border-2', 'border-cyber-blue');
                    state.intelligenceLevel = this.dataset.level;
                    
                    showToast(`‚úÖ ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ∞ŸÉÿßÿ° ÿ•ŸÑŸâ ${state.intelligenceLevel === 'creative' ? 'ÿ•ÿ®ÿØÿßÿπŸä' : 'ÿØŸÇŸäŸÇ'}`);
                });
            });
            
            elements.clearMemoryBtn.addEventListener('click', () => {
                if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ŸÖÿ≠ŸÅŸàÿ∏ÿßÿ™ ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ©ÿü')) {
                    conversationManager.clear();
                    elements.messagesWrapper.innerHTML = '';
                    showToast('üßπ ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿßŸÑÿ∞ÿßŸÉÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠');
                }
            });
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ÿØÿÆÿßŸÑ ==========
        function initInputSystem() {
            elements.userInput.addEventListener('input', function() {
                updateSendButton();
                
                const length = this.value.length;
                elements.charCount.textContent = length;
                
                if (length > 0) {
                    elements.charCounter.classList.remove('hidden');
                    
                    if (length > MAX_MESSAGE_LENGTH * 0.9) {
                        elements.charCounter.classList.add('text-red-500');
                    } else {
                        elements.charCounter.classList.remove('text-red-500');
                    }
                } else {
                    elements.charCounter.classList.add('hidden');
                }
                
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });
            
            elements.sendBtn.addEventListener('click', () => {
                const message = elements.userInput.value.trim();
                sendMessage(message);
                elements.userInput.value = '';
                elements.userInput.style.height = 'auto';
                updateSendButton();
            });
            
            elements.userInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    const message = elements.userInput.value.trim();
                    if (message) {
                        sendMessage(message);
                        elements.userInput.value = '';
                        elements.userInput.style.height = 'auto';
                        updateSendButton();
                    }
                }
                
                if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                    e.preventDefault();
                    const message = elements.userInput.value.trim();
                    if (message) {
                        sendMessage(message);
                        elements.userInput.value = '';
                        elements.userInput.style.height = 'auto';
                        updateSendButton();
                    }
                }
            });
        }
        
        function updateSendButton() {
            const hasText = elements.userInput.value.trim().length > 0;
            
            if (hasText && !state.isProcessing) {
                elements.sendBtn.classList.add('active');
                elements.sendBtn.disabled = false;
            } else {
                elements.sendBtn.classList.remove('active');
                elements.sendBtn.disabled = state.isProcessing;
            }
            
            if (hasText) {
                elements.sendBtn.classList.add('ignite');
            } else {
                elements.sendBtn.classList.remove('ignite');
            }
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≠ÿßŸÑÿ© ==========
        function showStatus(text) {
            elements.statusText.textContent = text;
            elements.statusIndicator.classList.remove('hidden');
            elements.statusIndicator.classList.add('flex');
        }
        
        function hideStatus() {
            elements.statusIndicator.classList.add('hidden');
            elements.statusIndicator.classList.remove('flex');
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿßÿ™ÿµÿßŸÑ ==========
        function checkConnection() {
            state.isConnected = navigator.onLine;
            
            if (!state.isConnected) {
                showConnectionError();
            } else {
                hideConnectionError();
            }
        }
        
        function showConnectionError() {
            elements.noConnection.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function hideConnectionError() {
            elements.noConnection.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ© ==========
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('‚úÖ ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ ÿ®ŸÜÿ¨ÿßÿ≠');
            }).catch(err => {
                console.error('Copy failed:', err);
                showToast('‚ùå ŸÅÿ¥ŸÑ ÿßŸÑŸÜÿ≥ÿÆ');
            });
        }
        
        function shareMessage(text) {
            if (navigator.share) {
                navigator.share({
                    title: 'ÿ±ÿ≥ÿßŸÑÿ© ŸÖŸÜ ÿµŸÅŸàÿßŸÜ - ÿßŸÑÿπŸÇŸÑ ÿßŸÑÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä',
                    text: text.substring(0, 100) + '...',
                    url: window.location.href
                }).catch(err => {
                    console.error('Share failed:', err);
                });
            } else {
                copyToClipboard(text);
                showToast('üìã ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ© ŸÑŸÑŸÖÿ¥ÿßÿ±ŸÉÿ©');
            }
        }
        
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'share-toast';
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-red-500/90 text-white px-6 py-3 rounded-xl z-50';
            errorDiv.textContent = message;
            
            document.body.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 3000);
        }
        
        // ========== ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÖÿ±ÿßŸÇÿ®ÿ© ==========
        function initMonitoring() {
            if ('memory' in performance) {
                setInterval(() => {
                    const memory = performance.memory;
                    const usedMB = Math.round(memory.usedJSHeapSize / 1048576);
                    const totalMB = Math.round(memory.totalJSHeapSize / 1048576);
                    elements.memoryUsage.textContent = `${usedMB}MB`;
                }, 5000);
            }
            
            setInterval(() => {
                const usage = 0.1 + Math.random() * 0.4;
                elements.cpuUsage.textContent = `${usage.toFixed(1)}%`;
            }, 3000);
            
            elements.chatContainer.addEventListener('scroll', updateScrollButton);
            elements.scrollBottom.addEventListener('click', () => scrollToBottom());
            
            window.addEventListener('online', checkConnection);
            window.addEventListener('offline', checkConnection);
        }
        
        // ========== ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ ==========
        async function initZenithSystem() {
            console.log(`
            ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
            ‚ïë                                                          ‚ïë
            ‚ïë   ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñà‚ñÄ‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñà‚ñÄ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñë‚ñë   ‚ïë
            ‚ïë   ‚ñë‚ñÄ‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñë‚ñà‚ñë‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñë‚ñà‚ñë‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñë‚ñë   ‚ïë
            ‚ïë   ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ   ‚ïë
            ‚ïë                                                          ‚ïë
            ‚ïë                Saf. GPT Zenith v4.0                      ‚ïë
            ‚ïë           ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä ŸÑŸÑŸÖŸÜÿ∑ŸÇ - ÿßŸÑŸÜÿ∏ÿßŸÖ ŸÜÿ¥ÿ∑             ‚ïë
            ‚ïë                 üîä ŸÜÿ∏ÿßŸÖ ÿßŸÑÿµŸàÿ™ ŸÖÿ≠ÿ≥ŸÜ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ               ‚ïë
            ‚ïë                                                          ‚ïë
            ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            `);
            
            initDynamicBackground();
            await voiceSystem.init();
            initFloatingInput();
            initSettings();
            initInputSystem();
            initMonitoring();
            checkConnection();
            
            conversationManager.updateMemoryDisplay();
            
            setTimeout(() => {
                elements.userInput.focus();
            }, 1000);
            
            setTimeout(() => {
                showToast('üöÄ ŸÜÿ∏ÿßŸÖ ÿ≤ŸäŸÜŸäÿ´ ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿ™ŸÅÿßÿπŸÑ ÿßŸÑÿµŸàÿ™Ÿä ŸàÿßŸÑŸÉÿ™ÿßÿ®Ÿä');
                
                setTimeout(() => {
                    if (state.isSpeaking) {
                        voiceSystem.speakText('ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ŸÜÿ∏ÿßŸÖ ÿ≤ŸäŸÜŸäÿ´ ŸÑŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿßÿ±ÿ≥ÿ™ŸÇÿ±ÿßÿ∑Ÿä ŸÑŸÑŸÖŸÜÿ∑ŸÇ. ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ™ÿ≠ÿØÿ´ ŸÖÿπŸä ÿ£Ÿà ÿßŸÑŸÉÿ™ÿßÿ®ÿ©.');
                    }
                }, 1500);
            }, 2000);
        }
        
        function initDynamicBackground() {
            if (state.energySaving) return;
            
            document.addEventListener('mousemove', (e) => {
                if (state.energySaving) return;
                
                const x = (e.clientX / window.innerWidth) * 100;
                const y = (e.clientY / window.innerHeight) * 100;
                
                elements.glow1.style.transform = `translate(${x - 50}%, ${y - 50}%)`;
                elements.glow2.style.transform = `translate(${100 - x}%, ${100 - y}%)`;
                elements.glow3.style.transform = `translate(${x}%, ${y}%)`;
            });
            
            document.addEventListener('touchmove', (e) => {
                if (state.energySaving || !e.touches[0]) return;
                
                const touch = e.touches[0];
                const x = (touch.clientX / window.innerWidth) * 100;
                const y = (touch.clientY / window.innerHeight) * 100;
                
                elements.glow1.style.transform = `translate(${x - 50}%, ${y - 50}%)`;
                elements.glow2.style.transform = `translate(${100 - x}%, ${100 - y}%)`;
                elements.glow3.style.transform = `translate(${x}%, ${y}%)`;
            });
            
            setInterval(() => {
                if (state.energySaving) return;
                
                const randomX = Math.random() * 100;
                const randomY = Math.random() * 100;
                
                elements.glow1.style.opacity = 0.2 + Math.random() * 0.3;
                elements.glow2.style.opacity = 0.2 + Math.random() * 0.3;
                elements.glow3.style.opacity = 0.2 + Math.random() * 0.3;
                
                elements.glow1.style.filter = `blur(${120 + Math.random() * 60}px)`;
                elements.glow2.style.filter = `blur(${120 + Math.random() * 60}px)`;
                elements.glow3.style.filter = `blur(${120 + Math.random() * 60}px)`;
            }, 3000);
        }
        
        Object.freeze(API_CONFIG);
        
        function sanitizeInput(input) {
            const div = document.createElement('div');
            div.textContent = input;
            return div.innerHTML;
        }
        
        function enableGPUAcceleration() {
            document.querySelectorAll('.gpu-accelerated').forEach(el => {
                el.style.transform = 'translate3d(0,0,0)';
            });
        }
        
        function lazyLoadIcons() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('loaded');
                        observer.unobserve(entry.target);
                    }
                });
            });
            
            document.querySelectorAll('.lazy-icon').forEach(icon => {
                observer.observe(icon);
            });
        }
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) ||
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                showToast('üîí ŸÜÿ∏ÿßŸÖ ÿ≤ŸäŸÜŸäÿ´ ŸÖÿ≠ŸÖŸä ŸÖŸÜ ÿßŸÑŸÅÿ≠ÿµ');
                return false;
            }
        });
        
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            showToast('üëë ÿßŸÑŸÜÿ∏ÿßŸÖ ŸÖÿ≠ŸÖŸä ÿ®ÿ≠ŸÇŸàŸÇ ÿßŸÑŸÖŸÑŸÉŸäÿ© ÿßŸÑŸÅŸÉÿ±Ÿäÿ©');
        });
        
        document.addEventListener('DOMContentLoaded', initZenithSystem);
    </script>
</body>
</html>
